<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Discord Activity Wrapper</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background: black;
      overflow: hidden;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
      display: block;
    }
  </style>
  <script type="module" crossorigin src="/assets/index-B5m0AmDU.js"></script>
</head>
<body>

  <!-- Script principal (Vite lo procesa) -->

  <!-- Iframe de tu juego -->
  <iframe id="game-frame" src="/game/index.html"></iframe>

<script>
/* ===========================================================
   üîå 1. FUNCI√ìN QUE LLAMA GODOT DESDE main.js (si quisieras usarla)
   =========================================================== */
window.sendAuthToGodot = function (payload) {
    if (window.__godot_callback) {
        window.__godot_callback(payload);
    } else {
        console.warn("Godot callback a√∫n no est√° listo:", payload);
    }
};

/* ===========================================================
   üî• 2. LISTENER OBLIGATORIO PARA RECIBIR postMessage DEL IFRAME
   =========================================================== */
window.addEventListener("message", (event) => {
    if (!event.data) return;

    // Solo manejamos el paquete enviado desde main.js ‚Üí iframe ‚Üí wrapper
    if (event.data.type === "discord-auth") {
        if (window.__godot_callback) {
            console.log("üì® Reenviando auth a Godot:", event.data);
            window.__godot_callback(event.data);
        } else {
            console.warn("‚ö†Ô∏è Godot callback NO listo a√∫n:", event.data);
        }
    }
});
</script>

</body>
</html>
