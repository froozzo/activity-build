<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Discord Activity Wrapper</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background: black;
      overflow: hidden;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
      display: block;
    }
  </style>
  <script type="module" crossorigin src="/assets/index-B5m0AmDU.js"></script>
</head>
<body>

  <!-- Tu script principal (Discord SDK, OAuth, etc.) -->

  <!-- AquÃ­ vive Godot -->
  <iframe id="game-frame" src="./game/index.html"></iframe>

<script>
/* ===========================================================
   1) FUNCION QUE main.js LLAMARÃ
   =========================================================== */
window.sendAuthToGodot = function (payload) {
    console.log("ðŸ“¨ Wrapper recibiÃ³ auth de main.js:", payload);

    const frame = document.getElementById("game-frame");

    if (!frame || !frame.contentWindow) {
        console.error("âŒ iframe no listo");
        return;
    }

    // ðŸ”¥ Enviamos la data hacia el iframe donde vive Godot
    frame.contentWindow.postMessage(payload, "*");

    console.log("âž¡ï¸ Enviado por postMessage al iframe");
};


/* ===========================================================
   2) RECIBIR EL MENSAJE *DENTRO DEL IFRAME*
   (Godot usarÃ¡ JSBridge para recibirlo)
   =========================================================== */
window.addEventListener("message", (event) => {
    if (!event.data) return;

    if (event.data.type === "discord-auth") {
        console.log("ðŸ“© Wrapper: mensaje desde iframe:", event.data);
    }
});
</script>

</body>
</html>
